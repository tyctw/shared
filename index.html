<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高中錄取分數分享平台</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
    <style>
      /* 頁面基礎樣式 */
      :root {
        --primary-color: #4a90e2;
        --secondary-color: #6c5ce7;
        --success-color: #00b894;
        --warning-color: #fdcb6e;
        --danger-color: #e17055;
        --light-color: #f5f6fa;
        --dark-color: #2d3436;
        --gradient-primary: linear-gradient(135deg, #4a90e2 0%, #6c5ce7 100%);
        --gradient-success: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
        --gradient-warning: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%);
        --gradient-info: linear-gradient(135deg, #0984e3 0%, #6c5ce7 100%);
        --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
        --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
        --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
        --transition-base: all 0.3s ease;
      }

      /* 全局樣式 */
      body {
        font-family: 'Poppins', sans-serif;
        background-color: var(--light-color);
        color: var(--dark-color);
        line-height: 1.6;
        background-image: 
          radial-gradient(circle at 100% 0%, rgba(74, 144, 226, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 0% 100%, rgba(108, 92, 231, 0.1) 0%, transparent 50%);
        background-attachment: fixed;
      }

      /* 導航欄樣式 */
      .navbar {
        background: var(--gradient-primary);
        box-shadow: var(--shadow-md);
        padding: 1rem 0;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        position: sticky;
        top: 0;
        z-index: 1000;
      }

      .navbar-brand {
        color: white !important;
        font-weight: 600;
        font-size: 1.5rem;
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .navbar-brand i {
        font-size: 1.75rem;
      }

      /* 卡片樣式 */
      .card {
        border: none;
        border-radius: 20px;
        box-shadow: var(--shadow-md);
        transition: var(--transition-base);
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        overflow: hidden;
        position: relative;
      }

      .card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
        opacity: 0;
        transition: var(--transition-base);
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .card:hover::before {
        opacity: 1;
      }

      .card-header {
        background: var(--gradient-primary);
        color: white;
        border: none;
        padding: 1.5rem;
        position: relative;
        overflow: hidden;
      }

      .card-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
        z-index: 1;
      }

      .card-header h3 {
        margin: 0;
        font-weight: 600;
        position: relative;
        z-index: 2;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .card-header h3 i {
        font-size: 1.5rem;
      }

      /* 按鈕樣式 */
      .btn {
        border-radius: 12px;
        padding: 0.75rem 1.5rem;
        font-weight: 500;
        transition: var(--transition-base);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        position: relative;
        overflow: hidden;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0) 100%);
        transition: all 0.6s;
      }

      .btn:hover::before {
        left: 100%;
      }

      .btn-primary {
        background: var(--gradient-primary);
        border: none;
      }

      .btn-success {
        background: var(--gradient-success);
        border: none;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      /* 表單元素樣式 */
      .form-control, .form-select {
        border-radius: 12px;
        padding: 0.75rem 1rem;
        border: 2px solid #e9ecef;
        transition: var(--transition-base);
        background: rgba(255, 255, 255, 0.9);
        font-size: 1rem;
      }

      .form-control:focus, .form-select:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(74, 144, 226, 0.25);
        background: white;
      }

      .form-label {
        font-weight: 500;
        color: var(--dark-color);
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      /* 標籤樣式 */
      .school-tag {
        border-radius: 20px;
        padding: 0.5rem 1rem;
        margin: 0.25rem;
        background: white;
        border: 2px solid var(--primary-color);
        color: var(--primary-color);
        transition: var(--transition-base);
        box-shadow: var(--shadow-sm);
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .school-tag:hover {
        background: var(--primary-color);
        color: white;
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      /* 動畫效果 */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .animate-fadeInUp {
        animation: fadeInUp 0.6s ease-out forwards;
      }

      /* 響應式設計 */
      @media (max-width: 768px) {
        .card {
          margin-bottom: 1.5rem;
        }
        
        .btn {
          width: 100%;
          margin-bottom: 0.5rem;
        }

        .navbar-brand {
          font-size: 1.25rem;
        }
      }


      /* 載入動畫 */
      .loading-animation {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }

      .loading-container {
        text-align: center;
        padding: 2rem;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.9);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .loading-spinner {
        position: relative;
        width: 80px;
        height: 80px;
        margin-bottom: 1.5rem;
      }

      .loading-spinner .dot {
        position: absolute;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--primary-color);
        animation: loading-dot 1.5s infinite ease-in-out;
      }

      .loading-spinner .dot:nth-child(1) {
        left: 0;
        animation-delay: 0s;
      }

      .loading-spinner .dot:nth-child(2) {
        left: 22px;
        animation-delay: 0.2s;
      }

      .loading-spinner .dot:nth-child(3) {
        left: 44px;
        animation-delay: 0.4s;
      }

      .loading-spinner .dot:nth-child(4) {
        left: 66px;
        animation-delay: 0.6s;
      }

      @keyframes loading-dot {
        0%, 100% {
          transform: translateY(0) scale(1);
          opacity: 1;
        }
        50% {
          transform: translateY(-20px) scale(0.8);
          opacity: 0.5;
        }
      }

      .loading-text {
        font-size: 1.1rem;
        font-weight: 500;
        color: var(--primary-color);
        margin-bottom: 1rem;
      }

      .loading-subtext {
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 1.5rem;
      }

      .loading-progress {
        width: 200px;
        height: 4px;
        background: #e9ecef;
        border-radius: 2px;
        overflow: hidden;
        position: relative;
      }

      .loading-progress .progress-bar {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 30%;
        background: var(--gradient-primary);
        border-radius: 2px;
        animation: progress-animation 1.5s infinite ease-in-out;
      }

      @keyframes progress-animation {
        0% {
          left: -30%;
        }
        100% {
          left: 100%;
        }
      }

      .loading-icon {
        font-size: 2rem;
        color: var(--primary-color);
        margin-bottom: 1rem;
        animation: icon-pulse 1.5s infinite ease-in-out;
      }

      @keyframes icon-pulse {
        0%, 100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(0.8);
          opacity: 0.5;
        }
      }

      /* 載入動畫響應式設計 */
      @media (max-width: 768px) {
        .loading-container {
          width: 90%;
          padding: 1.5rem;
        }

        .loading-spinner {
          width: 60px;
          height: 60px;
        }

        .loading-spinner .dot {
          width: 10px;
          height: 10px;
        }

        .loading-text {
          font-size: 1rem;
        }

        .loading-progress {
          width: 150px;
        }
      }

      /* 頁面標題樣式 */
      header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      header p {
        font-size: 1.2rem;
        color: #666;
        margin-bottom: 2rem;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
      }

      /* 統計卡片樣式 */
      .stats-card {
        background: white;
        border-radius: 20px;
        padding: 1.5rem;
        box-shadow: var(--shadow-md);
        transition: var(--transition-base);
        position: relative;
        overflow: hidden;
      }

      .stats-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
        opacity: 0;
        transition: var(--transition-base);
      }

      .stats-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .stats-card:hover::before {
        opacity: 1;
      }

      .stats-icon {
        width: 60px;
        height: 60px;
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.75rem;
        margin-bottom: 1rem;
        background: var(--gradient-primary);
        color: white;
        box-shadow: var(--shadow-md);
      }

      /* 分頁導航樣式 */
      .pagination {
        margin-top: 2rem;
      }

      .page-link {
        border-radius: 12px;
        margin: 0 0.25rem;
        border: none;
        color: var(--primary-color);
        transition: var(--transition-base);
        padding: 0.75rem 1rem;
      }

      .page-link:hover {
        background: var(--gradient-primary);
        color: white;
        transform: translateY(-2px);
      }

      .page-item.active .page-link {
        background: var(--gradient-primary);
        border: none;
      }

      /* 頁尾樣式 */
      footer {
        margin-top: 4rem;
        padding: 2rem 0;
        background: white;
        box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        position: relative;
        overflow: hidden;
      }

      footer::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
      }

      footer p {
        margin-bottom: 0.5rem;
        color: #666;
      }

      /* 模態框樣式 */
      .modal-content {
        border-radius: 20px;
        border: none;
        box-shadow: var(--shadow-lg);
        overflow: hidden;
      }

      .modal-header {
        background: var(--gradient-primary);
        color: white;
        border: none;
        padding: 1.5rem;
        position: relative;
      }

      .modal-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
      }

      .modal-body {
        padding: 2rem;
      }

      .modal-footer {
        border-top: 1px solid #eee;
        padding: 1.5rem;
      }

      /* 回到頂部按鈕樣式 */
      .back-to-top {
        position: fixed;
        bottom: 30px;
        left: 30px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: var(--gradient-primary);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition-base);
        box-shadow: var(--shadow-md);
        z-index: 1000;
      }

      .back-to-top.show {
        opacity: 1;
        visibility: visible;
      }

      .back-to-top:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .back-to-top i {
        font-size: 1.5rem;
        transition: var(--transition-base);
      }

      .back-to-top:hover i {
        transform: translateY(-2px);
      }

      /* 手機版優化 */
      @media (max-width: 768px) {
        .back-to-top {
          width: 40px;
          height: 40px;
          bottom: 20px;
          left: 20px;
        }

        .back-to-top i {
          font-size: 1.25rem;
        }
      }

      /* 圖表樣式 */
      .chart-container {
        position: relative;
        padding: 1.5rem;
        background: white;
        border-radius: 20px;
        box-shadow: var(--shadow-md);
        transition: var(--transition-base);
        overflow: hidden;
      }

      .chart-container:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }

      .chart-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
        opacity: 0;
        transition: var(--transition-base);
      }

      .chart-container:hover::before {
        opacity: 1;
      }

      .chart-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1.5rem;
      }

      .chart-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--dark-color);
        margin: 0;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .chart-title i {
        font-size: 1.5rem;
        color: var(--primary-color);
        background: rgba(74, 144, 226, 0.1);
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .chart-legend {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        color: #666;
      }

      .legend-color {
        width: 12px;
        height: 12px;
        border-radius: 3px;
      }

      .chart-tooltip {
        background: white;
        border-radius: 8px;
        padding: 0.75rem 1rem;
        box-shadow: var(--shadow-md);
        font-size: 0.875rem;
        color: var(--dark-color);
        pointer-events: none;
        opacity: 0;
        transition: var(--transition-base);
      }

      .chart-tooltip.show {
        opacity: 1;
      }

      .tooltip-title {
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .tooltip-value {
        color: var(--primary-color);
      }

      /* 柱狀圖樣式 */
      .bar-chart .bar {
        fill: var(--primary-color);
        transition: var(--transition-base);
      }

      .bar-chart .bar:hover {
        fill: var(--secondary-color);
      }

      .bar-chart .axis line,
      .bar-chart .axis path {
        stroke: #ddd;
      }

      .bar-chart .axis text {
        fill: #666;
        font-size: 0.75rem;
      }

      /* 折線圖樣式 */
      .line-chart .line {
        fill: none;
        stroke: var(--primary-color);
        stroke-width: 2;
        transition: var(--transition-base);
      }

      .line-chart .area {
        fill: url(#gradient);
        opacity: 0.1;
      }

      .line-chart .point {
        fill: white;
        stroke: var(--primary-color);
        stroke-width: 2;
        transition: var(--transition-base);
      }

      .line-chart .point:hover {
        fill: var(--primary-color);
      }

      /* 圓餅圖樣式 */
      .pie-chart .slice {
        transition: var(--transition-base);
      }

      .pie-chart .slice:hover {
        opacity: 0.8;
      }

      .pie-chart .label {
        font-size: 0.75rem;
        fill: #666;
      }

      /* 雷達圖樣式 */
      .radar-chart .area {
        fill: var(--primary-color);
        opacity: 0.1;
      }

      .radar-chart .line {
        fill: none;
        stroke: var(--primary-color);
        stroke-width: 2;
      }

      .radar-chart .point {
        fill: var(--primary-color);
      }

      /* 動畫效果 */
      @keyframes chartFadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .chart-animate {
        animation: chartFadeIn 0.6s ease-out forwards;
      }

      /* 手機版優化 */
      @media (max-width: 768px) {
        .chart-container {
          padding: 1rem;
        }

        .chart-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .chart-title {
          font-size: 1.125rem;
        }

        .chart-title i {
          width: 35px;
          height: 35px;
          font-size: 1.25rem;
        }

        .chart-legend {
          gap: 0.75rem;
        }

        .legend-item {
          font-size: 0.813rem;
        }
      }

      /* 菜單按鈕樣式 */
      .menu-toggle-btn {
        width: 40px;
        height: 40px;
        padding: 8px;
        border: none;
        background: transparent;
        position: relative;
        cursor: pointer;
        outline: none;
        transition: all 0.3s ease;
        border-radius: 8px;
      }

      .menu-toggle-btn:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .menu-toggle-icon {
        position: relative;
        width: 24px;
        height: 24px;
        display: block;
      }

      .menu-toggle-icon .line {
        position: absolute;
        height: 2px;
        width: 100%;
        background: white;
        border-radius: 2px;
        transition: all 0.3s ease;
        left: 0;
      }

      .menu-toggle-icon .line-1 {
        top: 4px;
      }

      .menu-toggle-icon .line-2 {
        top: 50%;
        transform: translateY(-50%);
      }

      .menu-toggle-icon .line-3 {
        bottom: 4px;
      }

      /* 菜單按鈕動畫效果 */
      .menu-toggle-btn.active .line-1 {
        transform: translateY(8px) rotate(45deg);
      }

      .menu-toggle-btn.active .line-2 {
        opacity: 0;
      }

      .menu-toggle-btn.active .line-3 {
        transform: translateY(-8px) rotate(-45deg);
      }

      .menu-toggle-btn:active {
        transform: scale(0.95);
      }

      /* 菜單按鈕觸控優化 */
      @media (hover: none) {
        .menu-toggle-btn {
          -webkit-tap-highlight-color: transparent;
        }
      }

      /* 菜單按鈕深色模式適配 */
      [data-theme="dark"] .menu-toggle-icon .line {
        background: #f5f6fa;
      }

      /* 分頁導航樣式優化 */
      .pagination-wrapper {
        background: rgba(255, 255, 255, 0.9);
        padding: 1rem;
        border-radius: 12px;
        box-shadow: var(--shadow-sm);
        margin-top: 1.5rem !important;
      }

      .pagination-info .badge {
        font-size: 0.9rem;
        padding: 0.5rem 0.75rem;
      }

      .pagination-nav .pagination {
        margin-bottom: 0;
      }

      .pagination-nav .page-link {
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
        padding: 0.5rem 0.75rem;
        transition: all 0.3s ease;
        margin: 0 2px;
      }

      .pagination-nav .page-item.active .page-link {
        background: var(--gradient-primary);
        border-color: transparent;
        color: white;
        font-weight: 500;
      }

      .pagination-nav .page-item:not(.active) .page-link:hover {
        background: var(--gradient-primary);
        color: white;
        transform: translateY(-2px);
      }

      .page-size-selector .input-group {
        width: auto;
      }

      .page-size-selector .form-select {
        min-width: 100px;
        cursor: pointer;
      }

      .page-size-selector .input-group-text {
        border-top-left-radius: 8px;
        border-bottom-left-radius: 8px;
      }

      .page-size-selector .form-select {
        border-top-right-radius: 8px;
        border-bottom-right-radius: 8px;
      }

      /* 動畫效果 */
      .pagination-wrapper {
        animation: fadeInUp 0.3s ease-out;
      }

      @media (max-width: 768px) {
        .pagination-wrapper {
          flex-direction: column;
          gap: 1rem;
          align-items: center;
        }

        .pagination-info {
          order: 2;
        }

        .pagination-nav {
          order: 1;
        }

        .page-size-selector {
          order: 3;
          width: 100%;
        }

        .page-size-selector .input-group {
          width: 100%;
        }
      }
    </style>
    <meta name="theme-color" content="#0d6efd">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
    <!-- 頁首導航菜單 -->
    <nav class="navbar navbar-expand-lg sticky-top" id="main-navbar">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="bi bi-journal-check"></i>高中分數分享</a>
            <button class="navbar-toggler d-none" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <i class="bi bi-list fs-3"></i>
            </button>
            
            <!-- 漢堡選單按鈕 -->
            <button id="menu-toggle-btn" class="menu-toggle-btn gpu-accelerated">
                <span class="menu-toggle-icon">
                    <span class="line line-1"></span>
                    <span class="line line-2"></span>
                    <span class="line line-3"></span>
                </span>
            </button>
        </div>
    </nav>
    
    <!-- 右側彈出菜單 -->
    <div id="sidebar-menu" class="sidebar-menu">
        <button id="close-menu-btn" class="close-btn">
            <i class="bi bi-x-lg"></i>
        </button>
        <div class="pt-4 pb-2 text-center">
            <h5 class="fw-bold text-primary mb-0"><i class="bi bi-journal-check me-2"></i>選單</h5>
        </div>
        <div class="pt-2">
            <a href="https://rcpett.vercel.app/" class="menu-item active">
                <i class="bi bi-house-door"></i>首頁
            </a>
            <a href="https://caprcpet.vercel.app/" class="menu-item">
                <i class="bi bi-share"></i>落點分析
            </a>
            <a href="https://tyctw.github.io/report_form" class="menu-item">
                <i class="bi bi-search"></i>異常回報
            </a>
            <a href="#results-section" class="menu-item">
                <i class="bi bi-list-stars"></i>錄取資料
            </a>
            <a href="https://tyctw.github.io/Navigation/n" class="menu-item">
                <i class="bi bi-bar-chart"></i>更多資訊
            </a>
            <div class="border-top my-3"></div>
            <a href="javascript:void(0)" class="btn btn-primary menu-btn help-btn">
                <i class="bi bi-lightbulb me-2"></i>使用說明
            </a>
        </div>
    </div>
    
    <!-- 側邊欄背景遮罩 -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <div class="container">
        <header class="mb-4 mt-3 text-center">
            <h1 class="floating-element gpu-accelerated"><i class="bi bi-journal-check me-2"></i>高中錄取分數分享平台</h1>
            <p class="lead gpu-accelerated">分享你的會考成績與錄取高中，幫助學弟妹了解各校錄取分數區間</p>
        </header>

        <!-- 右上角使用說明按鈕 -->
        <div class="position-fixed top-0 end-0 m-3 mt-5 d-none d-lg-block" style="z-index: 1030;">
            <button class="btn btn-primary rounded-circle shadow help-btn gpu-accelerated" style="width: 45px; height: 45px;" data-bs-toggle="tooltip" data-bs-placement="left" title="使用說明">
                <i class="bi bi-question-lg"></i>
            </button>
        </div>

        <div class="row">
            <div class="col-lg-6 mb-4" id="share-section">
                <div class="card mb-4 glass-card card-3d gpu-accelerated">
                    <div class="card-header gradient-card-header">
                        <h3 class="mb-0"><i class="bi bi-share me-2"></i>分享你的錄取資訊</h3>
                    </div>
                    <div class="card-body">
                        <form id="score-form">
                            <div class="mb-3">
                                <label for="year" class="form-label"><i class="bi bi-calendar-event me-1"></i>會考年份</label>
                                <select class="form-select" id="year" required data-bs-toggle="tooltip" data-bs-placement="right" title="請選擇您參加會考的年份">
                                    <option value="" selected disabled>請選擇年份</option>
                                    <option value="114">114年 (2025)</option>
                                    <option value="113">113年 (2024)</option>
                                    <option value="112">112年 (2023)</option>
                                    <option value="111">111年 (2022)</option>
                                    <option value="110">110年 (2021)</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="school" class="form-label"><i class="bi bi-building me-1"></i>錄取學校</label>
                                <input type="text" class="form-control" id="school" placeholder="例：建國中學" required data-bs-toggle="tooltip" data-bs-placement="right" title="請輸入您錄取的學校全名">
                            </div>
                            <div class="mb-3">
                                <label for="department" class="form-label"><i class="bi bi-book me-1"></i>科系/班別</label>
                                <select class="form-select" id="department" data-bs-toggle="tooltip" data-bs-placement="right" title="請選擇您錄取的科系或班別，普通高中可選擇「普通班」">
                                    <option value="" selected disabled>請選擇科系或班別</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="region" class="form-label"><i class="bi bi-geo-alt me-1"></i>所屬區域</label>
                                <select class="form-select" id="region" required data-bs-toggle="tooltip" data-bs-placement="right" title="請選擇學校所在的免試入學區域">
                                    <option value="" selected disabled>請選擇區域</option>
                                    <option value="基北區">基北區</option>
                                    <option value="桃連區">桃連區</option>
                                    <option value="竹苗區">竹苗區</option>
                                    <option value="中投區">中投區</option>
                                    <option value="雲林區">雲林區</option>
                                    <option value="彰化區">彰化區</option>
                                    <option value="嘉義區">嘉義區</option>
                                    <option value="台南區">台南區</option>
                                    <option value="高雄區">高雄區</option>
                                    <option value="屏東區">屏東區</option>
                                    <option value="宜蘭區">宜蘭區</option>
                                    <option value="花蓮區">花蓮區</option>
                                    <option value="澎湖區">澎湖區</option>
                                    <option value="金門區">金門區</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label"><i class="bi bi-award me-1"></i>會考成績</label>
                                <div class="row g-2">
                                    <div class="col">
                                        <label for="chinese" class="form-label">國文</label>
                                        <select class="form-select" id="chinese" required data-bs-toggle="tooltip" data-bs-placement="top" title="選擇您國文科的會考成績">
                                            <option value="" selected disabled>請選擇</option>
                                            <option value="A++">A++</option>
                                            <option value="A+">A+</option>
                                            <option value="A">A</option>
                                            <option value="B++">B++</option>
                                            <option value="B+">B+</option>
                                            <option value="B">B</option>
                                            <option value="C">C</option>
                                        </select>
                                    </div>
                                    <div class="col">
                                        <label for="english" class="form-label">英文</label>
                                        <select class="form-select" id="english" required data-bs-toggle="tooltip" data-bs-placement="top" title="選擇您英文科的會考成績">
                                            <option value="" selected disabled>請選擇</option>
                                            <option value="A++">A++</option>
                                            <option value="A+">A+</option>
                                            <option value="A">A</option>
                                            <option value="B++">B++</option>
                                            <option value="B+">B+</option>
                                            <option value="B">B</option>
                                            <option value="C">C</option>
                                        </select>
                                    </div>
                                    <div class="col">
                                        <label for="math" class="form-label">數學</label>
                                        <select class="form-select" id="math" required data-bs-toggle="tooltip" data-bs-placement="top" title="選擇您數學科的會考成績">
                                            <option value="" selected disabled>請選擇</option>
                                            <option value="A++">A++</option>
                                            <option value="A+">A+</option>
                                            <option value="A">A</option>
                                            <option value="B++">B++</option>
                                            <option value="B+">B+</option>
                                            <option value="B">B</option>
                                            <option value="C">C</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row g-2 mt-2">
                                    <div class="col">
                                        <label for="science" class="form-label">自然</label>
                                        <select class="form-select" id="science" required data-bs-toggle="tooltip" data-bs-placement="bottom" title="選擇您自然科的會考成績">
                                            <option value="" selected disabled>請選擇</option>
                                            <option value="A++">A++</option>
                                            <option value="A+">A+</option>
                                            <option value="A">A</option>
                                            <option value="B++">B++</option>
                                            <option value="B+">B+</option>
                                            <option value="B">B</option>
                                            <option value="C">C</option>
                                        </select>
                                    </div>
                                    <div class="col">
                                        <label for="social" class="form-label">社會</label>
                                        <select class="form-select" id="social" required data-bs-toggle="tooltip" data-bs-placement="bottom" title="選擇您社會科的會考成績">
                                            <option value="" selected disabled>請選擇</option>
                                            <option value="A++">A++</option>
                                            <option value="A+">A+</option>
                                            <option value="A">A</option>
                                            <option value="B++">B++</option>
                                            <option value="B+">B+</option>
                                            <option value="B">B</option>
                                            <option value="C">C</option>
                                        </select>
                                    </div>
                                    <div class="col">
                                        <label for="composition" class="form-label">作文</label>
                                        <select class="form-select" id="composition" required data-bs-toggle="tooltip" data-bs-placement="bottom" title="選擇您國文寫作測驗的級分">
                                            <option value="" selected disabled>級分</option>
                                            <option value="0">0級</option>
                                            <option value="1">1級</option>
                                            <option value="2">2級</option>
                                            <option value="3">3級</option>
                                            <option value="4">4級</option>
                                            <option value="5">5級</option>
                                            <option value="6">6級</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row g-2 mb-3">
                                <div class="col-md-6">
                                    <label for="total" class="form-label"><i class="bi bi-calculator me-1"></i>總積分</label>
                                    <input type="number" class="form-control" id="total" min="0" max="100" step="0.01" placeholder="例：97.5" data-bs-toggle="tooltip" data-bs-placement="top" title="依各校計算方式得出的總積分，如不確定可留空由系統估算">
                                </div>
                                <div class="col-md-6">
                                    <label for="totalPoints" class="form-label"><i class="bi bi-award me-1"></i>總積點</label>
                                    <input type="number" class="form-control" id="totalPoints" min="0" max="35" step="1" placeholder="例：28" data-bs-toggle="tooltip" data-bs-placement="top" title="五科成績換算的總積點，如不確定可留空由系統估算">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="comment" class="form-label"><i class="bi bi-chat-square-text me-1"></i>附加說明 (選填)</label>
                                <textarea class="form-control" id="comment" rows="2" placeholder="例：加分條件、特殊管道錄取、心得..." data-bs-toggle="tooltip" data-bs-placement="top" title="可填寫其他補充說明，如特殊管道錄取、多元學習表現加分等"></textarea>
                            </div>
                            <div class="mb-3">
                                <div class="h-captcha" data-sitekey="87f06f80-1ea2-4a22-95e2-93f08616a8e4" data-theme="light"></div>
                                <div id="captcha-error" class="text-danger small mt-1" style="display: none;">
                                    <i class="bi bi-exclamation-triangle-fill me-1"></i>請完成人機驗證
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary w-100"><i class="bi bi-send me-1"></i>分享我的成績</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="card mb-4" id="search-section">
                    <div class="card-header success-gradient-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <h3 class="mb-0"><i class="bi bi-search me-2"></i>搜尋錄取資訊</h3>
                            <a href="#" class="text-white" data-bs-toggle="collapse" data-bs-target="#advancedFilters">
                                <i class="bi bi-funnel"></i> 進階篩選
                            </a>
                        </div>
                    </div>
                    <div class="card-body">
                        <form id="search-form" class="mb-3">
                            <div class="input-group">
                                <span class="input-group-text bg-light"><i class="bi bi-search"></i></span>
                                <input type="text" class="form-control" id="search-input" placeholder="輸入學校或科系關鍵字...">
                                <button class="btn btn-success" type="submit">搜尋</button>
                            </div>
                        </form>
                        <div class="mb-3">
                            <label class="form-label"><i class="bi bi-geo-alt me-1"></i>選擇區域</label>
                            <div class="region-filter" id="region-filter">
                                <button class="region-btn active" data-region="all" id="region-all"><i class="bi bi-globe-asia-australia me-1"></i>全部區域</button>
                                <button class="region-btn" data-region="基北區"><i class="bi bi-geo me-1"></i>基北區</button>
                                <button class="region-btn" data-region="桃連區"><i class="bi bi-geo me-1"></i>桃連區</button>
                                <button class="region-btn" data-region="竹苗區"><i class="bi bi-geo me-1"></i>竹苗區</button>
                                <button class="region-btn" data-region="中投區"><i class="bi bi-geo me-1"></i>中投區</button>
                                <button class="region-btn" data-region="雲林區"><i class="bi bi-geo me-1"></i>雲林區</button>
                                <button class="region-btn" data-region="彰化區"><i class="bi bi-geo me-1"></i>彰化區</button>
                                <button class="region-btn" data-region="嘉義區"><i class="bi bi-geo me-1"></i>嘉義區</button>
                                <button class="region-btn" data-region="台南區"><i class="bi bi-geo me-1"></i>台南區</button>
                                <button class="region-btn" data-region="高雄區"><i class="bi bi-geo me-1"></i>高雄區</button>
                                <button class="region-btn" data-region="屏東區"><i class="bi bi-geo me-1"></i>屏東區</button>
                                <button class="region-btn" data-region="宜蘭區"><i class="bi bi-geo me-1"></i>宜蘭區</button>
                                <button class="region-btn" data-region="花蓮區"><i class="bi bi-geo me-1"></i>花蓮區</button>
                                <button class="region-btn" data-region="澎湖區"><i class="bi bi-geo me-1"></i>澎湖區</button>
                                <button class="region-btn" data-region="金門區"><i class="bi bi-geo me-1"></i>金門區</button>
                            </div>
                        </div>
                        
                        <!-- 進階篩選區塊 -->
                        <div id="advancedFilters" class="collapse mt-3">
                            <div class="filter-container">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="filter-title mb-0"><i class="bi bi-funnel"></i> 進階篩選條件</h5>
                                    <span id="clear-filters" class="clear-filters">
                                        <i class="bi bi-x-circle"></i> 清除所有篩選
                                    </span>
                                </div>
                                
                                <!-- 年份篩選 -->
                                <div class="filter-group" id="year-filter">
                                    <div class="filter-title fs-6">會考年份：</div>
                                    <div class="filter-chip" data-year="114"><i class="bi bi-calendar"></i> 114年</div>
                                    <div class="filter-chip" data-year="113"><i class="bi bi-calendar"></i> 113年</div>
                                    <div class="filter-chip" data-year="112"><i class="bi bi-calendar"></i> 112年</div>
                                    <div class="filter-chip" data-year="111"><i class="bi bi-calendar"></i> 111年</div>
                                    <div class="filter-chip" data-year="110"><i class="bi bi-calendar"></i> 110年</div>
                                </div>
                                
                                <!-- 積分範圍篩選 -->
                                <div class="filter-title fs-6">積分區間：</div>
                                <div class="score-filter" id="score-range-filter">
                                    <div class="score-filter-btn" data-min="90" data-max="117">90分以上</div>
                                    <div class="score-filter-btn" data-min="80" data-max="90">80-90分</div>
                                    <div class="score-filter-btn" data-min="70" data-max="80">70-80分</div>
                                    <div class="score-filter-btn" data-min="60" data-max="70">60-70分</div>
                                    <div class="score-filter-btn" data-min="0" data-max="60">60分以下</div>
                                </div>
                                
                                <!-- 科目篩選 -->
                                <div class="filter-title fs-6 mt-3">國文成績：</div>
                                <div class="filter-group subject-filter" data-subject="chinese">
                                    <div class="filter-chip" data-grade="A++">A++</div>
                                    <div class="filter-chip" data-grade="A+">A+</div>
                                    <div class="filter-chip" data-grade="A">A</div>
                                    <div class="filter-chip" data-grade="B++">B++</div>
                                    <div class="filter-chip" data-grade="B+">B+</div>
                                </div>
                                
                                <div class="filter-title fs-6 mt-3">英文成績：</div>
                                <div class="filter-group subject-filter" data-subject="english">
                                    <div class="filter-chip" data-grade="A++">A++</div>
                                    <div class="filter-chip" data-grade="A+">A+</div>
                                    <div class="filter-chip" data-grade="A">A</div>
                                    <div class="filter-chip" data-grade="B++">B++</div>
                                    <div class="filter-chip" data-grade="B+">B+</div>
                                </div>
                                
                                <div class="filter-title fs-6 mt-3">數學成績：</div>
                                <div class="filter-group subject-filter" data-subject="math">
                                    <div class="filter-chip" data-grade="A++">A++</div>
                                    <div class="filter-chip" data-grade="A+">A+</div>
                                    <div class="filter-chip" data-grade="A">A</div>
                                    <div class="filter-chip" data-grade="B++">B++</div>
                                    <div class="filter-chip" data-grade="B+">B+</div>
                                </div>
                                
                                <!-- 作文級分篩選 -->
                                <div class="filter-title fs-6 mt-3">作文級分：</div>
                                <div class="filter-group" id="composition-filter">
                                    <div class="filter-chip" data-level="6"><i class="bi bi-pencil"></i> 6級</div>
                                    <div class="filter-chip" data-level="5"><i class="bi bi-pencil"></i> 5級</div>
                                    <div class="filter-chip" data-level="4"><i class="bi bi-pencil"></i> 4級</div>
                                    <div class="filter-chip" data-level="3"><i class="bi bi-pencil"></i> 3級</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 篩選結果計數 -->
                        <div class="mt-3 text-muted fs-6">
                            目前顯示 <span id="filter-result-count">0</span> 筆符合條件的資料
                        </div>
                        
                        <div id="stats-section" class="card mb-4 gpu-accelerated">
                            <div class="card-header info-gradient-header">
                                <h3 class="mb-0"><i class="bi bi-bar-chart me-2"></i>統計資訊</h3>
                            </div>
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-3">
                                    <div class="p-3 bg-light rounded-circle me-3">
                                        <i class="bi bi-file-earmark-text" style="font-size: 1.5rem; color: #0d6efd;"></i>
                                    </div>
                                    <div>
                                        <div class="text-muted">累計分享資料</div>
                                        <div class="fs-4 fw-bold" id="total-entries">0</div>
                                    </div>
                                </div>
                                <div class="d-flex align-items-center mb-3">
                                    <div class="p-3 bg-light rounded-circle me-3">
                                        <i class="bi bi-building" style="font-size: 1.5rem; color: #fd7e14;"></i>
                                    </div>
                                    <div>
                                        <div class="text-muted">最熱門學校</div>
                                        <div class="fs-5 fw-bold" id="popular-school">暫無資料</div>
                                    </div>
                                </div>
                                <div id="chart-container" style="height: 220px;">
                                    <svg id="stats-chart" width="100%" height="100%"></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mb-4" id="results-section">
            <div class="card-header warning-gradient-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h3 class="mb-0"><i class="bi bi-list-stars me-2"></i>最新分享資訊</h3>
                    <div class="d-flex gap-2">
                        <div class="dropdown">
                            <button class="btn btn-sm btn-light dropdown-toggle gpu-accelerated" id="sort-dropdown" data-bs-toggle="dropdown">
                                <i class="bi bi-sort-down me-1"></i>排序方式
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item sort-option" data-sort="newest" href="#"><i class="bi bi-clock me-2"></i>最新分享</a></li>
                                <li><a class="dropdown-item sort-option" data-sort="highest" href="#"><i class="bi bi-arrow-down-up me-2"></i>積分高至低</a></li>
                                <li><a class="dropdown-item sort-option" data-sort="lowest" href="#"><i class="bi bi-arrow-up-down me-2"></i>積分低至高</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            <div class="card-body">
                <div id="results-container">
                    <!-- 分享資料會顯示在這裡 -->
                </div>
                
                <!-- 分頁導航保持不變 -->
                <div class="d-flex justify-content-between align-items-center mt-4 pagination-wrapper">
                    <div class="pagination-info">
                        <span class="badge bg-primary rounded-pill">
                            <i class="bi bi-file-text me-1"></i>
                            第 <span id="currentPage" class="fw-bold">1</span> 頁，共 <span id="totalPages" class="fw-bold">1</span> 頁
                        </span>
                    </div>
                    
                    <nav aria-label="Page navigation" class="pagination-nav">
                        <ul class="pagination pagination-sm mb-0">
                            <li class="page-item disabled" id="prevPage">
                                <a class="page-link rounded-start" href="#" aria-label="Previous">
                                    <i class="bi bi-chevron-left"></i>
                                </a>
                            </li>
                            <li class="page-item active"><a class="page-link" href="#" data-page="1">1</a></li>
                            <li class="page-item disabled" id="nextPage">
                                <a class="page-link rounded-end" href="#" aria-label="Next">
                                    <i class="bi bi-chevron-right"></i>
                                </a>
                            </li>
                        </ul>
                    </nav>
                    
                    <div class="page-size-selector">
                        <div class="input-group input-group-sm">
                            <label class="input-group-text bg-primary text-white border-primary">
                                <i class="bi bi-list-ul"></i>
                            </label>
                            <select class="form-select form-select-sm border-primary" id="pageSizeSelect" aria-label="每頁顯示筆數">
                                <option value="10">10 筆/頁</option>
                                <option value="20">20 筆/頁</option>
                                <option value="50">50 筆/頁</option>
                            </select>
                        </div>
                    </div>
                </div>

                <style>
                    /* 分頁導航樣式優化 */
                    .pagination-wrapper {
                        background: rgba(255, 255, 255, 0.9);
                        padding: 1rem;
                        border-radius: 12px;
                        box-shadow: var(--shadow-sm);
                        margin-top: 1.5rem !important;
                    }

                    .pagination-info .badge {
                        font-size: 0.9rem;
                        padding: 0.5rem 0.75rem;
                    }

                    .pagination-nav .pagination {
                        margin-bottom: 0;
                    }

                    .pagination-nav .page-link {
                        border: 1px solid var(--primary-color);
                        color: var(--primary-color);
                        padding: 0.5rem 0.75rem;
                        transition: all 0.3s ease;
                        margin: 0 2px;
                    }

                    .pagination-nav .page-item.active .page-link {
                        background: var(--gradient-primary);
                        border-color: transparent;
                        color: white;
                        font-weight: 500;
                    }

                    .pagination-nav .page-item:not(.active) .page-link:hover {
                        background: var(--gradient-primary);
                        color: white;
                        transform: translateY(-2px);
                    }

                    .page-size-selector .input-group {
                        width: auto;
                    }

                    .page-size-selector .form-select {
                        min-width: 100px;
                        cursor: pointer;
                    }

                    .page-size-selector .input-group-text {
                        border-top-left-radius: 8px;
                        border-bottom-left-radius: 8px;
                    }

                    .page-size-selector .form-select {
                        border-top-right-radius: 8px;
                        border-bottom-right-radius: 8px;
                    }

                    /* 動畫效果 */
                    .pagination-wrapper {
                        animation: fadeInUp 0.3s ease-out;
                    }

                    @media (max-width: 768px) {
                        .pagination-wrapper {
                            flex-direction: column;
                            gap: 1rem;
                            align-items: center;
                        }

                        .pagination-info {
                            order: 2;
                        }

                        .pagination-nav {
                            order: 1;
                        }

                        .page-size-selector {
                            order: 3;
                            width: 100%;
                        }

                        .page-size-selector .input-group {
                            width: 100%;
                        }
                    }
                </style>
            </div>
        </div>

        <footer class="text-center text-muted mb-3">
            <p><i class="bi bi-heart-fill me-1 text-danger"></i> 2025 高中錄取分數分享平台 | 本平台僅供參考，錄取標準依各高中公告為準</p>
            <p class="mb-0">
                <button class="btn btn-sm btn-outline-primary animated-btn help-btn gpu-accelerated">
                    <i class="bi bi-info-circle me-1"></i>使用說明
                </button>
            </p>
        </footer>
    </div>

    <!-- 使用說明模態框 -->
    <div class="modal fade" id="helpModal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="helpModalLabel"><i class="bi bi-lightbulb"></i>平台使用說明</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="guide-steps">
                        <div class="guide-step-btn active" data-step="intro">
                            <i class="bi bi-info-circle"></i>
                            <span>平台介紹</span>
                        </div>
                        <div class="guide-step-btn" data-step="share">
                            <i class="bi bi-share"></i>
                            <span>分享資訊</span>
                        </div>
                        <div class="guide-step-btn" data-step="search">
                            <i class="bi bi-search"></i>
                            <span>搜尋資訊</span>
                        </div>
                        <div class="guide-step-btn" data-step="score">
                            <i class="bi bi-calculator"></i>
                            <span>積分計算</span>
                        </div>
                        <div class="guide-step-btn" data-step="faq">
                            <i class="bi bi-question-circle"></i>
                            <span>常見問題</span>
                        </div>
                    </div>
                    
                    <div class="guide-step-content active" id="intro-content">
                        <h5><i class="bi bi-info-circle"></i>平台介紹</h5>
                        <p>高中錄取分數分享平台是一個讓會考生分享錄取資訊的網站，幫助學弟妹了解各校錄取分數區間，做出更好的志願選擇。</p>
                        
                        <div class="row mt-4">
                            <div class="col-md-6 mb-3">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="bi bi-share"></i>
                                    </div>
                                    <h6 class="fw-bold">分享錄取資訊</h6>
                                    <p class="mb-0 small text-muted">分享你的會考成績與錄取高中，幫助更多學弟妹。</p>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="bi bi-search"></i>
                                    </div>
                                    <h6 class="fw-bold">查詢學校分數</h6>
                                    <p class="mb-0 small text-muted">搜尋特定學校的錄取分數，了解錄取趨勢。</p>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="bi bi-bar-chart"></i>
                                    </div>
                                    <h6 class="fw-bold">統計分析</h6>
                                    <p class="mb-0 small text-muted">查看熱門學校統計數據，了解整體趨勢。</p>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="bi bi-shield-check"></i>
                                    </div>
                                    <h6 class="fw-bold">資料安全</h6>
                                    <p class="mb-0 small text-muted">所有資料僅用於統計分析，不會收集個人隱私。</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="guide-tip mt-4">
                            <i class="bi bi-lightbulb me-2"></i> <strong>使用建議：</strong> 瀏覽各學校資料時，請記得不同年份的錄取標準可能有所不同，僅供參考。最終錄取標準請以各校公告為準。
                        </div>
                    </div>
                    
                    <div class="guide-step-content" id="share-content">
                        <h5><i class="bi bi-share"></i>如何分享錄取資訊</h5>
                        <p>分享你的會考成績與錄取學校，可以幫助更多學弟妹了解各校錄取情況，做出更好的選擇。</p>
                        
                        <ol class="mt-3">
                            <li class="mb-3">前往「分享你的錄取資訊」區塊</li>
                            <li class="mb-3">填寫會考年份、錄取學校和科系班別</li>
                            <li class="mb-3">選擇學校所屬區域（如基北區、中投區等）</li>
                            <li class="mb-3">選擇您的會考五科成績 (A++、A+、A、B++、B+、B、C)</li>
                            <li class="mb-3">選擇作文級分 (0-6級)</li>
                            <li class="mb-3">填寫總積分和總積點 (如果不確定，系統會自動估算)</li>
                            <li class="mb-3">可填寫附加說明 (選填，例如特殊條件或心得)</li>
                            <li>點擊「分享我的成績」按鈕提交資料</li>
                        </ol>
                        
                        <div class="guide-tip mt-3">
                            <i class="bi bi-info-circle me-2"></i> <strong>提示：</strong> 總積分和總積點會根據您選擇的成績自動計算，但您也可以手動修改為實際錄取分數。
                        </div>
                        
                        <div class="guide-tip warning mt-3">
                            <i class="bi bi-exclamation-triangle me-2"></i> <strong>注意：</strong> 請填寫真實資訊，以確保平台資料的準確性和參考價值。
                        </div>
                    </div>
                    
                    <div class="guide-step-content" id="search-content">
                        <h5><i class="bi bi-search"></i>如何搜尋錄取資訊</h5>
                        <p>您可以搜尋特定學校或科系的錄取資訊，了解不同成績區間的學生獲錄取的情況。</p>
                        
                        <h6 class="mt-4 mb-3">搜尋方式：</h6>
                        <ol>
                            <li class="mb-2">使用搜尋框輸入學校或科系名稱關鍵字</li>
                            <li class="mb-2">點擊「搜尋」按鈕</li>
                            <li class="mb-2">或直接點擊快速選擇區的學校標籤</li>
                            <li class="mb-2">您也可以通過選擇特定區域（如基北區、高雄區）來過濾學校</li>
                        </ol>
                        
                        <h6 class="mt-4 mb-3">排序結果：</h6>
                        <p>搜尋結果可依照以下方式排序：</p>
                        <ul>
                            <li class="mb-2">最新分享 (預設) - 顯示最新分享的資料</li>
                            <li class="mb-2">積分高至低 - 依總積分從高到低排序</li>
                            <li class="mb-2">積分低至高 - 依總積分從低到高排序</li>
                        </ul>
                        
                        <div class="guide-tip mt-3">
                            <i class="bi bi-lightbulb me-2"></i> <strong>搜尋技巧：</strong> 您可以輸入部分學校名稱(如「建中」、「北一」)或是科系關鍵字(如「資訊」、「數理」)來尋找相關資料。
                        </div>
                    </div>
                    
                    <div class="guide-step-content" id="score-content">
                        <h5><i class="bi bi-calculator"></i>積分與積點計算說明</h5>
                        <p>了解會考成績如何轉換為積分和積點，以及各高中如何使用這些數據進行錄取。</p>
                        
                        <h6 class="mt-4">積點計算方式：</h6>
                        <p>會考各科成績轉換為積點：</p>
                        <div class="table-responsive">
                            <table class="table table-bordered table-sm text-center">
                                <thead class="table-light">
                                    <tr>
                                        <th>成績</th>
                                        <th>A++</th>
                                        <th>A+</th>
                                        <th>A</th>
                                        <th>B++</th>
                                        <th>B+</th>
                                        <th>B</th>
                                        <th>C</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>積點</td>
                                        <td>7</td>
                                        <td>6</td>
                                        <td>5</td>
                                        <td>4</td>
                                        <td>3</td>
                                        <td>2</td>
                                        <td>1</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="small text-muted mt-2">總積點 = 五科積點總和 (最高35點)</p>
                        
                        <h6 class="mt-4">積分計算方式：</h6>
                        <p>積分通常包含多種加權方式，一般來說：</p>
                        <ul>
                            <li class="mb-2">五科會考成績轉積點後乘以3 (105分)</li>
                            <li class="mb-2">作文級分乘以2 (12分)</li>
                            <li class="mb-2">部分學校會有特別加權科目</li>
                        </ul>
                        <p class="small text-muted">總積分 = (五科積點總和×3) + (作文級分×2) + 其他加分項目</p>
                        
                        <div class="guide-tip mt-3">
                            <i class="bi bi-info-circle me-2"></i> <strong>注意：</strong> 各校計算方式可能有差異，本系統提供的是一般計算方式的估算值，實際分數請參考各校公告。
                        </div>
                        
                        <div class="guide-tip warning mt-3">
                            <i class="bi bi-exclamation-triangle me-2"></i> <strong>重要提醒：</strong> 若您知道確切的積分計算結果，建議在分享時手動修改為實際數值。
                        </div>
                    </div>
                    
                    <div class="guide-step-content" id="faq-content">
                        <h5><i class="bi bi-question-circle"></i>常見問題</h5>
                        
                        <div class="accordion mt-3" id="faqAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingOne">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        分享的資料會被用於什麼用途？
                                    </button>
                                </h2>
                                <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        您分享的資料僅用於統計分析和提供其他學生參考，不會被用於商業用途，也不會收集個人隱私資訊。
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingTwo">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                        我應該填寫什麼科系/班別？
                                    </button>
                                </h2>
                                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        請填寫您所錄取的科系或班別名稱，例如「普通班」、「資訊班」、「數理班」等。若學校沒有特別區分，可填寫「普通班」或留空。
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingThree">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                        如果我是透過特殊管道錄取，應該如何標註？
                                    </button>
                                </h2>
                                <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        請在「附加說明」欄位註明您是透過什麼特殊管道錄取，例如「特色招生」、「體育績優」、「音樂班」、「政策傾斜」等，這樣能提供更完整的參考資訊。
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingFour">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                        資料有誤時可以修改或刪除嗎？
                                    </button>
                                </h2>
                                <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        目前平台暫不支持個人修改或刪除已提交的資料。如發現資料有誤，請通過平台下方的聯絡方式告知管理員，我們會盡快協助處理。
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingFive">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                                        平台的資料來源可靠嗎？
                                    </button>
                                </h2>
                                <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        平台的資料由使用者自行分享，雖然我們鼓勵提供真實資訊，但無法百分百驗證每筆資料的準確性。因此，資料僅供參考，最終錄取標準請以各學校官方公告為準。
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">關閉</button>
                    <button type="button" class="btn btn-primary animated-btn" data-bs-dismiss="modal">我了解了</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Calculator Modal -->
    <div class="modal fade" id="calculatorModal" tabindex="-1" aria-labelledby="calculatorModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header gradient-card-header">
                    <h5 class="modal-title text-white" id="calculatorModalLabel"><i class="bi bi-calculator me-2"></i>會考積分計算器</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">會考成績</label>
                        <div class="row g-2">
                            <div class="col-6 col-md-4 mb-2">
                                <label class="small">國文</label>
                                <select class="form-select form-select-sm calc-subject" data-subject="chinese">
                                    <option value="7">A++</option>
                                    <option value="6">A+</option>
                                    <option value="5">A</option>
                                    <option value="4">B++</option>
                                    <option value="3">B+</option>
                                    <option value="2">B</option>
                                    <option value="1">C</option>
                                </select>
                            </div>
                            <div class="col-6 col-md-4 mb-2">
                                <label class="small">英文</label>
                                <select class="form-select form-select-sm calc-subject" data-subject="english">
                                    <option value="7">A++</option>
                                    <option value="6">A+</option>
                                    <option value="5">A</option>
                                    <option value="4">B++</option>
                                    <option value="3">B+</option>
                                    <option value="2">B</option>
                                    <option value="1">C</option>
                                </select>
                            </div>
                            <div class="col-6 col-md-4 mb-2">
                                <label class="small">數學</label>
                                <select class="form-select form-select-sm calc-subject" data-subject="math">
                                    <option value="7">A++</option>
                                    <option value="6">A+</option>
                                    <option value="5">A</option>
                                    <option value="4">B++</option>
                                    <option value="3">B+</option>
                                    <option value="2">B</option>
                                    <option value="1">C</option>
                                </select>
                            </div>
                            <div class="col-6 col-md-4 mb-2">
                                <label class="small">自然</label>
                                <select class="form-select form-select-sm calc-subject" data-subject="science">
                                    <option value="7">A++</option>
                                    <option value="6">A+</option>
                                    <option value="5">A</option>
                                    <option value="4">B++</option>
                                    <option value="3">B+</option>
                                    <option value="2">B</option>
                                    <option value="1">C</option>
                                </select>
                            </div>
                            <div class="col-6 col-md-4 mb-2">
                                <label class="small">社會</label>
                                <select class="form-select form-select-sm calc-subject" data-subject="social">
                                    <option value="7">A++</option>
                                    <option value="6">A+</option>
                                    <option value="5">A</option>
                                    <option value="4">B++</option>
                                    <option value="3">B+</option>
                                    <option value="2">B</option>
                                    <option value="1">C</option>
                                </select>
                            </div>
                            <div class="col-6 col-md-4 mb-2">
                                <label class="small">作文</label>
                                <select class="form-select form-select-sm calc-subject" data-subject="composition">
                                    <option value="6">6級</option>
                                    <option value="5">5級</option>
                                    <option value="4">4級</option>
                                    <option value="3">3級</option>
                                    <option value="2">2級</option>
                                    <option value="1">1級</option>
                                    <option value="0">0級</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="card bg-light">
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-6">
                                    <h5 class="mb-0" id="calc-total-points">0</h5>
                                    <small class="text-muted">總積點</small>
                                </div>
                                <div class="col-6">
                                    <h5 class="mb-0" id="calc-total-score">0</h5>
                                    <small class="text-muted">總積分</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <p class="small text-muted">
                            <i class="bi bi-info-circle me-1"></i> 此計算器使用一般免試入學積分計算方式，各校實際計算方式可能有差異，僅供參考。
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Data Modal -->
    <div class="modal fade" id="exportModal" tabindex="-1" aria-labelledby="exportModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header success-gradient-header">
                    <h5 class="modal-title text-white" id="exportModalLabel"><i class="bi bi-download me-2"></i>匯出資料</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>選擇您要匯出的資料格式：</p>
                    <div class="d-grid gap-2">
                        <button id="export-csv" class="btn btn-outline-primary"><i class="bi bi-filetype-csv me-2"></i>CSV 格式</button>
                        <button id="export-json" class="btn btn-outline-primary"><i class="bi bi-filetype-json me-2"></i>JSON 格式</button>
                        <button id="export-print" class="btn btn-outline-primary"><i class="bi bi-printer me-2"></i>列印當前結果</button>
                    </div>
                    <div class="mt-3">
                        <p class="small text-muted">
                            <i class="bi bi-info-circle me-1"></i> 僅匯出當前篩選後的結果資料。
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Favorites Modal -->
    <div class="modal fade" id="favoritesModal" tabindex="-1" aria-labelledby="favoritesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header info-gradient-header">
                    <h5 class="modal-title text-white" id="favoritesModalLabel"><i class="bi bi-bookmark-heart me-2"></i>我的收藏</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="favorites-list" class="list-group">
                        <!-- Favorites will be populated here -->
                    </div>
                    <div id="no-favorites" class="text-center py-4">
                        <i class="bi bi-bookmark text-muted fs-1"></i>
                        <p class="mt-3 text-muted">您尚未收藏任何記錄</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="clear-favorites" class="btn btn-outline-danger me-auto"><i class="bi bi-trash me-1"></i>清空收藏</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
                </div>
            </div>
        </div>
    </div>

    <div id="loading-overlay" style="display: none;" class="glass-effect">
        <div class="loading-animation gpu-accelerated">
            <div class="loading-circles">
                <div class="circle"></div>
                <div class="circle"></div>
                <div class="circle"></div>
            </div>
            <div class="loading-text">資料載入中</div>
            <div class="loading-progress">
                <div class="progress-bar shimmer-effect"></div>
            </div>
        </div>
    </div>

    <!-- 回到頂部按鈕 -->
    <div class="back-to-top" id="backToTop">
      <i class="bi bi-arrow-up"></i>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script>
    <script src="script.js"></script>
    
    <script>
      // 確保Apps Script已正確設置為網路應用程式
      // 1. 確認已部署為網路應用程式(Web App)
      // 2. 確認權限設置為"所有人，甚至匿名使用者"
      // 3. 確認在部署後已執行新網址
    </script>
    <script>
      // 頁面載入完成後去除載入動畫
      window.addEventListener('load', function() {
        document.body.classList.add('page-loaded');
      });
      
      // 給頁面元素添加動畫類並使用GPU加速
      document.querySelectorAll('.card, .school-tag, .btn, header h1, header p').forEach((element, index) => {
        element.classList.add('gpu-accelerated');
        setTimeout(() => {
          element.classList.add('in-view');
        }, index * 100 + 200);
      });
      
      // 優化圖片載入
      document.querySelectorAll('img').forEach(img => {
        img.setAttribute('loading', 'lazy');
      });
      
      // 應用平滑滾動到所有內部連結
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          if(this.getAttribute('href') !== '#') {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if(target) {
              window.scrollTo({
                top: target.offsetTop - 80,
                behavior: 'smooth'
              });
            }
          }
        });
      });
    </script>
        <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H9X7EC127P"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H9X7EC127P');
</script>

<script>
  // 回到頂部按鈕功能
  const backToTop = document.getElementById('backToTop');
  
  window.addEventListener('scroll', () => {
    if (window.pageYOffset > 300) {
      backToTop.classList.add('show');
    } else {
      backToTop.classList.remove('show');
    }
  });

  backToTop.addEventListener('click', () => {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  });
</script>

    <!-- 載入動畫 -->
    <div id="loading-overlay" class="loading-animation" style="display: none;">
        <div class="loading-container">
            <div class="loading-icon">
                <i class="bi bi-cloud-arrow-down"></i>
            </div>
            <div class="loading-spinner">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
            <div class="loading-text">資料載入中</div>
            <div class="loading-subtext">請稍候片刻...</div>
            <div class="loading-progress">
                <div class="progress-bar"></div>
            </div>
        </div>
    </div>
</body>
</html>